% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_validate_gsea_above_bootstrap.R
\name{validate_gsea_above_bootstrap}
\alias{validate_gsea_above_bootstrap}
\title{Bootstrap validation of enrichment for genes above a threshold}
\usage{
validate_gsea_above_bootstrap(
  result,
  threshold = 0,
  n_boot = 5000,
  title = "Bootstrap validation of enrichment",
  base_size = 14
)
}
\arguments{
\item{result}{A list returned by \code{gsea_single_vector()}, containing
at least \code{ranking} (named numeric vector) and \code{hits}.}

\item{threshold}{Numeric threshold applied to the ranking score to define
"above" genes.}

\item{n_boot}{Number of bootstrap samples (random gene sets) to generate.
Default is 5000.}

\item{title}{Character string specifying the title of the output plot.}

\item{base_size}{Base font size for the ggplot2 theme.}
}
\value{
A list containing:
\itemize{
  \item \code{plot}: A ggplot2 object showing the bootstrap null distribution
    and the observed statistic.
  \item \code{observed}: The observed statistic.
  \item \code{null_distribution}: Numeric vector of bootstrap statistics.
  \item \code{p_value}: Empirical p-value.
  \item \code{n_above}: Number of genes above threshold in the gene set.
}
}
\description{
This function evaluates whether genes classified as "above threshold" in a
GSEA ranking are enriched compared to random gene sets of the same size
sampled from the whole transcriptome. The statistic used is the sum of
ranking scores for the "above threshold" genes, compared to a bootstrap
null distribution obtained by repeated random sampling.
}
\details{
The function compares the observed statistic (sum of ranking scores for
genes above threshold within the gene set) to a null distribution obtained
by repeatedly sampling random gene sets of identical size from the entire
ranked transcriptome. The empirical p-value corresponds to the probability
that a random gene set achieves a statistic greater than or equal to the
observed value.
}
\examples{
\dontrun{
res <- gsea_single_vector(expr, geneset)
v <- validate_gsea_above_bootstrap(
  result = res,
  threshold = 0,
  n_boot = 5000,
  title = "Bootstrap validation"
)
print(v$plot)
v$p_value
}

}
