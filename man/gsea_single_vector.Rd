% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/01_gsea_single_vector.R
\name{gsea_single_vector}
\alias{gsea_single_vector}
\title{Single-sample GSEA (Gene Set Enrichment Analysis)}
\usage{
gsea_single_vector(
  expr_col,
  genes_input,
  rank_method = c("zscore", "log", "raw"),
  n_perm = 5000
)
}
\arguments{
\item{expr_col}{A named numeric vector of gene expression values.
Gene names must be stored in \code{names(expr_col)}.}

\item{genes_input}{A character vector containing the genes of the gene set.}

\item{rank_method}{Ranking method used to transform the expression vector.
One of \code{"zscore"}, \code{"log"}, or \code{"raw"}.}

\item{n_perm}{Number of permutations used to estimate the empirical p-value.
Default is 5000.}
}
\value{
A list containing:
\itemize{
  \item \code{ranking}: The ranked expression vector (decreasing order).
  \item \code{hits}: Logical vector indicating which ranked genes belong
    to the input gene set.
  \item \code{running_ES}: The running enrichment score curve.
  \item \code{ES}: The enrichment score.
  \item \code{NES}: The normalized enrichment score.
  \item \code{p_value}: Empirical p-value based on permutations.
  \item \code{genes_present}: Genes from the input gene set found in the
    expression vector.
}
}
\description{
Computes a single-sample GSEA enrichment score for a given expression vector
and a gene set. This function implements the classical running-sum statistic
described in Subramanian et al. (2005), including permutation-based
p-values and normalized enrichment score (NES).
}
\details{
The function ranks all genes in decreasing order and computes the running
enrichment score (ES) based on weighted hits and misses. Permutations are
performed by shuffling the hit positions while keeping the ranking fixed.
}
\examples{
\dontrun{
expr <- rnorm(1000)
names(expr) <- paste0("Gene", 1:1000)
geneset <- sample(names(expr), 50)
res <- gsea_single_vector(expr, geneset)
}

}
