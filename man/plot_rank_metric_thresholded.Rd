% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04_plot_rank_metric.R
\name{plot_rank_metric_thresholded}
\alias{plot_rank_metric_thresholded}
\title{Plot the ranking metric with threshold-aware gene set highlighting}
\usage{
plot_rank_metric_thresholded(
  result,
  threshold = 0,
  title = "Rank metric (threshold-aware)",
  base_size = 14
)
}
\arguments{
\item{result}{A list returned by \code{gsea_single_vector()}, containing:
\itemize{
  \item \code{ranking}: Numeric vector of ranking scores (sorted decreasingly).
  \item \code{hits}: Logical vector indicating which genes belong to the gene set.
  \item \code{running_ES}: Numeric vector of the running enrichment score.
}}

\item{threshold}{Numeric threshold applied to the ranking score to classify
gene set members as above or below threshold.}

\item{title}{Character string specifying the plot title.}

\item{base_size}{Base font size for the ggplot2 theme.}
}
\value{
A ggplot2 object.
}
\description{
This function visualizes the ranking metric used in GSEA and highlights
genes from the gene set according to whether their ranking score is above
or below a user-defined threshold. It provides a complementary view to the
running enrichment score by showing how strongly each gene contributes to
the ranking metric.
}
\details{
The plot displays the ranking metric across the transcriptome, with vertical
bars marking the positions of genes belonging to the gene set. Bars are
colored according to whether the gene's ranking score exceeds the specified
threshold. No vertical line for the ES peak is drawn in this version.
}
\examples{
\dontrun{
# Simulated example
expr <- rnorm(1000)
names(expr) <- paste0("Gene", 1:1000)
geneset <- sample(names(expr), 50)

# Compute GSEA result
res <- gsea_single_vector(expr, geneset)

# Plot threshold-aware ranking metric
p <- plot_rank_metric_thresholded(
  result = res,
  threshold = 0,
  title = "Rank metric (threshold-aware)"
)

print(p)
}

}
